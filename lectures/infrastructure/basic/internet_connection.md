<!-- $theme: default -->
<!-- page_number: true -->

# インターネット接続について
- 講義実施者 : 荒木　泰詞
- 講義実施日 : 2018-08-XX

---
## 今回のゴール
- どのようにしてインターネット接続ができているか理解する

---
## アジェンダ
- ベース知識
  - プロトコル
  - TCP/IP
  - デフォルトゲートウェイ
  - ルーター
  - ドメイン
- インターネット接続の流れ

---
## インターネットにはどうやって接続しているかご存知ですか？

---
## 必要となる知識
- プロトコル
- TCP/IP
- ルーター
- ドメイン

---
## プロトコル
### プロトコルとは、コンピュータとコンピュータが通信するときのルール
- 相互が理解できる同じプロトコルを使わないと通信は成立しない
- 代表的なものが`IP (Internet Protocol)`
  - 標準になっているのが`TCP/IP`
- その他のプロトコル
  - FTP (File Transfer Protocol)
  - SMTP (Simple Mail Transfer Protocol)
  - HTTP (Hypertext Transfer Protocol)
- インターネットプロトコルを用いて繋げられたネットワークのことを`インターネット`と呼ぶ

---
## TCP/IP
### TCP/IP (Transmission Control Protocol / Internet Protocol)とは、TCPとIPの組み合わせ

### TCPとは、伝達制御プロトコル
- 送ったデータが相手に届いたか、その都度確認しながら通信する

- スピードは遅い

### IPとは、データやパケットを通信するプロトコル
- データを相手に送るのが目的
- 送ったデータが相手に届いたかはわからない
- スピードは早い

### TCPとIPの両方を使うことで、確実な通信ができるようになる
- TCP/IPはOSに標準搭載

---
## Ethernet
### Ethernet(イーサネット)とは、通信を行う物理規格
- プロトコルの一種
- 有線LAN、無線LANのことを指す
- PCに標準搭載されている

### データの通信をするときにはEthernetとTCP/IPが関連している

---
## TCP/IP階層
### TCP/IPは４つの階層に分かれている
- ４つに分けることで、仕様変更があっても変更が必要な層のみに影響を留める
- 一つ一つの役割を明確にする
- TCP/IPはTCPとIPのプロトコルの組み合わせといったが、実は他のプロトコルも含まれている

---
## TCP/IP階層

||階層名|役割|プロトコル例|
|-|-|-|-|
|4|アプリケーション層|アプリケーション間のやり取り|HTTP|
|3|トランスポート層|プログラム間の通信、通信の制御|TCP|
|2|インターネット層|インターネットワークでの通信|IP|
|1|ネットワーク・インターフェース層|同一ネットワーク上での通信、ハードウェア仕様など|Ethernet|

---
## TCP/IP階層 - データの流れ
- データを送るときは上の階層から下の階層へ渡される
  - 各層ではデータの先頭に付加情報を加える
- データを受け取るときは下の階層から上の階層へ渡される

![center 110%](https://camo.qiitausercontent.com/13350dd9bff5af51dbc2393193653f32b6f34edd/68747470733a2f2f71696974612d696d6167652d73746f72652e73332e616d617a6f6e6177732e636f6d2f302f35303138352f37346566656534652d643738622d323134342d386338622d3261393438653363653864622e706e67)

<!-- *footer: 引用:https://qiita.com/genreh/items/05186691fbf8c10a4a48 -->

---
### データを送るまでの流れ
## ブラウザでhttp://www.example.comにアクセス

|順番|階層名|内容|
|-|-|-|
|1|HTTP|HTTPリクエスト作成|
|2|TCP|送信元ポート・送信先ポート番号追加|
|3|IP|送信元、送信先IPアドレス追加|
|4|Ethernet|ビット列・電気信号に変えてLANで運ぶ| 

---
## LANでデータを運ぶ入り口とは
### デフォルトゲートウェイがデータを送るときの入り口

### デフォルトゲートウェイとは、異なるネットワーク同士を接続するネットワーク機器のこと
- 単語本来の`玄関`の意味どおり、他のネットワークと通信する際に必ず通らなければならない`接続ポイント`
- ネットワークの行き先を示すIPアドレスを設定
  - そのIPアドレスはルータのIPアドレスを設定する

---
## データを送っても一発では相手に届かない

### なぜ？
- ネットワークが巨大だから

### どうやって届けている？
- ルーターを使っている

---
## ルーター
### ルーターとは、異なるネットワークを相互に接続するネットワーク機器
- IPアドレスから次の行き先を教えてくれる
- ルーター同士でお互いのIPアドレスを知っている
- 最適な経路を選択して転送することを`ルーティング`という

![center 170%](https://beginners-network.com/image/routing_2.gif)

<!-- *footer: 引用: https://beginners-network.com/routing.html -->

---
## ドメイン
### ドメインとは、インターネット上に存在するコンピュータやネットワークを識別するための名前
- `http://www.example.com`でいうところの`example.com`
  - `www`はホスト名という
- コンピュータを特定しているのはIPアドレス
- IPアドレスは数字の羅列であり、人が覚えるのは難しいので、名前をつける
- ドメインとIPアドレスを紐付けるのがDNS(Domain Name System)

---
## DNS
### DNSとは、ドメインに対するIPアドレスが何かを教えてくれるシステム
- DNSにはルートサーバがあり、それが中核となっている
- ツリー構造で構成される
- 目的のドメインサーバーがIPアドレスを知っている

### ドメイン構成
```
example.co.jp
   │     │  └ トップレベルドメイン
   │     └─── 第２レベルドメイン 
   └───────── 第３レベルドメイン
```

### サーバ構成
```
ルートサーバ ┬ ".jp"サーバ - "xxx.jp"サーバ
　　　　　　 ├ ".net"サーバ - "xxx.net"サーバ
　　　　　　 └ ".com"サーバ - "xxx.com"サーバ
```

---
## ドメインからIPアドレスを取得する流れ
![center 150%](http://xn--u8j7eobcu7j2kyg7f.jp/special/dns/images/page_02/img_01.gif)

<!-- *footer: 引用: http://ドメインまるわかり.jp/special/dns/page_02.html -->

---
## インターネット接続の流れ
|順番|階層名|内容|
|-|-|-|
|1|HTTP|HTTPリクエスト作成|
|2|TCP|送信元ポート・送信先ポート番号追加|
|3|IP|送信元、送信先IPアドレス追加|
|4|Ethernet|ビット列・電気信号に変え LANでデフォルトゲートウェイに設定されたルータへ運ぶ| 
![center 150%](https://beginners-network.com/image/nagare_1.gif)

<!-- *footer: 引用: https://beginners-network.com/nagare.html -->

---
## tracerouteを使ってネットワークの経路を確認
### 自分のPCのデフォルトゲートウェイ設定確認
- システム環境設定 > ネットワーク > 詳細 > TCP/IP > ルーター
- macでは`ルータ`として表示される

### ターミナルからtracerouteを実行
```
traceroute www.google.com
```

```
-- 実行結果
1 デフォルトゲートウェイのIPアドレス  xxxms
...
13 xxx.yyy.zzz(google.comのIPアドレス)
```
- 実行結果の最後にgoogle.comのIPアドレスが表示されるので、そのIPアドレスでもgoogle.comが表示できる

---
## まとめ
- TCP/IPによってインターネットに接続できる土台がある
- ルータがあることによって様々なネットワークにつながる
- DNSによってIPアドレスを意識しなくてインターネットに繋がる