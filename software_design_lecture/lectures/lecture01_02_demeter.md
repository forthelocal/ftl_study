# 開発クオリティ向上のためのノウハウ講義
## 第一回目 ノウハウ体系の脳内マップ
### 例として デメテルの法則について
* 作成者：石井 尊 
* 作成日 : 2018-08-17
* 講義実施日 : 2018-08-17

---
# デメテルの法則の要点
* 「直接の隣人のみに話かけよう」という内容
* 他のオブジェクトについての詳しい知識を必要としないようにしようということ

# ノウハウ脳内マップでの位置
脳内マップ構造上の位置では

```
クオリティの高い開発を効率良く行う
  ┗ [知識編] 変更の容易なプログラムを作るための知識
    ┗ 依存性の低さ
```
だなと感じてもらえれば良い。

---
# 悪い例で説明

* 寿司屋のシステムがあるとする。
* その寿司屋ではサイドメニューとしてオレンジジュースを提供している。
* オレンジジュースにはサイズにSとMとがある。
* Sサイズのオレンジジュースは毎週水曜日に20円引きになる。

このとき「寿司屋クラス」が「オレンジジュースSサイズの水曜日の価格を取得する」というメソッドを持っているとする。

```
class SushiShop {
  public function getOrangeJuiceSsizePriceAtWednesday() {
    return $this->side_menus->orange_juice->s->price -20;
  }
}
```

---
## 依存性が高い
寿司屋クラスがこのメソッドのために知らなくてはならない知識が多い。
* サイドメニューにオレンジジュースが存在する
* オレンジジュースにはSサイズがある
* オレンジジュースSは水曜日に20円割り引かれる

寿司屋と直接関係のない以下のような変更の際に寿司屋クラスも同時に変更しなくてはならなくなる。
* オレンジジュースSの割引日の変更
* オレンジジュースSの割引額の変更
* メニューからオレンジジュースSが削除される

---
## 寿司屋の隣人は誰か
今回の設計では各オブジェクトの関係は以下のようになっていると考えられる。

```
 寿司屋
    ├── サイドメニュー
    │   ├── デザート
    │   │   └── スイカケーキ
    │   └── ドリンク
    │       ├── オレンジジュース
    │       │   ├── Mサイズ
    │       │   └── Sサイズ
    │       └── スイカスムージー
    │           └── Lサイズ
    └── メインメニュー
        ├── 寿司
        │   ├── マグロの赤身
        │   └── ・・・
        └── 蕎麦
            └── 天ぷらそば
```

→ 寿司屋の直接の隣人は「メインメニュー」「サイドメニュー」

---
# デメテルの法則＠寿司屋クラス

```
class SushiShop {
  public function getMainMenus(): array {
    return $this->main_menus;
  }

  public function getSideMenus(): array {
    return $this->side_menus;
  }
}
```

↓  
サイドメニューからオレンジジュースが消滅しようが、寿司屋クラスを変更する必要はない。
